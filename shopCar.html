<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/shopcar.css" />
		<link rel="stylesheet" type="text/css" href="css/footer.css" />
		<link rel="stylesheet" type="text/css" href="css/reset.css" />
		<script src="js/cookie.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/jquery-1.11.1.min.js" type="text/javascript" charset="utf-8"></script>
	</head>

	<body>
		<!--头部-->
		<div id="header">
			<div class="h-top">
				<div class="h-t-nav">
					<div class="h-left">
						<p class="h-left-p1"><i class="h-tel"></i>电话热线<span class="h-telnum">400-630-0077</span></p>
					</div>
					<p class="h-center">
						<a href="login.html" class="h-c-login">[登录]</a>
						<a href="register.html">[免费注册]</a>
					</p>
					<ul id="h-right">
						<li>
							<a href="#">我的嘉</a>
						</li>
						<li>
							<a href="#">我的订单</a>
						</li>
						<li>
							<a href="#">客户服务</a>
						</li>
						<li>
							<a href="#">电视会员激活</a>
						</li>
						<li><i class="h-phone"></i>
							<a href="#">手机嘉丽购</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="h-bottom">
				<a href="#"><img src="img/ladygood.png" /></a>
				<span class="h-tit"><i></i>购物车</span>

			</div>
		</div>
		<!--商品购物清单-->
		<div id="shopCar">
			<p>全部商品</p>
			<!--<div class="s-box" style="height: 180px;border: 1px solid #ccc; line-height: 180px;text-align: center;">
				<p style="font-size: 14px;">购物车还是空的^_^</p>
			</div>-->
			<form action="#" method="post">
				<ul class="s-t-nav">
					<li>全选</li>
					<li>商品名</li>
					<li>单价（元）</li>
					<li>数量</li>
					<li>嘉丽价</li>
					<li>操作</li>
				</ul>
				<div class="s-table">
					<div class="shoplist">
						<!--<ul class="s-t-pro">
							<li>
								<div class="btnCk">
									<input type="checkbox" name="check" id="check" />
								</div>
								<img src="img/5b9f7530d6865.jpg"/>
							</li>
							<li class="proname">
								<p><a href="#">科沃斯机器人20周年家有特供组</a></p>	
								<p>货号：<i>20123380</i></p>
								<p>颜色/尺码 ：<br />
								<span>科沃斯机器人20周年家有特供组_ 共同共同</span>
								</p>
							</li>
							<li>￥1299.00</li>
							<li class="numDo">
								<a href="#" id="reduce"> - </a>
								<span id="num"> 3 </span>
								<a href="#" id="add"> + </a>
							</li>
							<li><span class="jlprice">¥1,299.00</span></li>
							<li>
								<a href="#" id="joinCol">加入收藏夹</a>
								<a href="#" id="del">删除</a>
							</li>
						</ul>-->
					</div>
					<ul class="s-t-jiesuan">
						<li class="s-t-j-cz">
							<label><input type="checkbox" name="allck" id="allck" />全选</label>

							<span class="alldel">清空购物车</span>
							<div class="money">
								<p>件数：<span class='count2'>0</span>件</p>
								<p>总计：<span class='money2'>0</span>元</p>
							</div>
						</li>
						<li class="submit">
							<button id="jiesuan">去结算</button>
						</li>
					</ul>
				</div>
			</form>
		</div>
		<!--猜你喜欢-->
		<div id="like">
			<p>猜你喜欢</p>
			<ul class="l-ul">
				<!--<li>
					<a href="#"><img src="img/5a71cae69de74.jpg" /></a>
					<p>电波紧肤多功能美容仪</p>
					<p>￥299.00</p>
					<a href="#" class="joinCar">加入购物车</a>
				</li>
				<li>
					<a href="#"><img src="img/5a71d18529dfc.jpg" /></a>
					<p>尼蔻微电波能美容仪</p>
					<p>￥499.00</p>
					<a href="#" class="joinCar">加入购物车</a>
				</li>
				<li>
					<a href="#"><img src="img/5a72f01dbc768.jpg" /></a>
					<p>波紧肤多功能美容仪</p>
					<p>￥349.00</p>
					<a href="#" class="joinCar">加入购物车</a>
				</li>
				<li>
					<a href="#"><img src="img/5a2dedff2878a.jpg" /></a>
					<p>尼紧肤多功能美容仪</p>
					<p>￥149.00</p>
					<a href="#" class="joinCar">加入购物车</a>
				</li>
				<li>
					<a href="#"><img src="img/5af3d988a08a1.jpg" /></a>
					<p>电波紧肤多功能美容仪</p>
					<p>￥129.00</p>
					<a href="#" class="joinCar">加入购物车</a>
				</li>-->
			</ul>
		</div>
		<!--尾部 footer-->
		<div id="footer">
			<div class="f-head">
				<!--正品保证 正品行货 开具发票 快捷配送 严格包装 无损签收 货到付款 支付宝 银联在线支付-->
			</div>
			<div class="f-help">
				<div class="f-help-left">
					<img src="img/jlg_2d.jpg" />
				</div>
				<div class="f-help-center">
					<dl>
						<dt>购物指南</dt>
						<dd>
							<a href="#">新用户指南/激活</a>
						</dd>
						<dd>
							<a href="#">如何订购</a>
						</dd>
						<dd>
							<a href="#">常见问题</a>
						</dd>
					</dl>
					<dl>
						<dt>会员中心</dt>
						<dd>
							<a href="#">会员权益</a>
						</dd>
						<dd>
							<a href="#">美丽积分</a>
						</dd>
						<dd>
							<a href="#">订单查询</a>
						</dd>
						<dd>
							<a href="#">找回密码</a>
						</dd>
					</dl>
					<dl>
						<dt>配送中心</dt>
						<dd>
							<a href="#">物流跟踪</a>
						</dd>
						<dd>
							<a href="#">免运费政策</a>
						</dd>
					</dl>
					<dl>
						<dt>支付说明</dt>
						<dd>
							<a href="#">货到付款</a>
						</dd>
						<dd>
							<a href="#">在线支付</a>
						</dd>
					</dl>
					<dl>
						<dt>售后服务</dt>
						<dd>
							<a href="#">退换货政策</a>
						</dd>
						<dd>
							<a href="#">退换货流程</a>
						</dd>
						<dd>
							<a href="#">安全与保密</a>
						</dd>
					</dl>
				</div>
				<div class="f-help-right"></div>
			</div>
			<div class="f-bottom">
				<p>
					<a href="#">商场首页</a> |
					<a href="#">官网首页</a> |
					<a href="#">供应商登录</a> |
					<a href="#">供货联系</a> |
					<a href="#">收藏我们</a> |
					<a href="#">公司简介</a> |
					<a href="#">媒体报道</a> |
					<a href="#">嘉丽购招聘</a> |
					<a href="#">官方微博</a> |
					<a href="#">营业证照</a>
				</p>
				<p class="f-p-color">嘉丽购物有限责任公司 Copyright 2010-2014 jialigou.All Rights Reserved</p>
				<p class="f-p-color">国家广电总局批号：广局[2010] 278号
					<a href="#">湘ICP备10203162号-3</a>
				</p>
				<p>
					<a href="#"><img src="img/pic.gif" /></a>
				</p>
				<p class="f-b-bottom">
					<img src="img/kx.jpg" alt="" />
					<a href="#"><img src="img/360.jpg" /></a>
					<img src="img/alipay_s.gif" />
					<a href="#"><img src="img/hn110_s.gif" /></a>
				</p>
			</div>
		</div>
	</body>

</html>
<script type="text/javascript">
	window.onload = function() {
		var arr = getCookie('shoplist');
		var str = "";
		for(var i = 0; i < arr.length; i++) {
			var pro = arr[i];
			str += `
				<ul class="s-t-pro">
						<li>
							<div class="btnCk">
								<input type="checkbox" name="check" class="ck" />
							</div>
							<img src="img/${pro.src}"/>
						</li>
						<li class="proname">
							<p><a href="#">${pro.name}</a></p>	
							<p>货号：<i>${pro.id}</i></p>
							<p>颜色/尺码 ：<br />
							<span>${pro.name}_ 共同共同</span>
							</p>
						</li>
						<li>${pro.price}</li>
						<li class="numDo" data-name='${pro.name}' data-id='${pro.id}' data-src='${pro.src}' data-count='${pro.count}' data-price='${pro.price}'>
							<a href="#" class="jiajian" data-number='-1'> - </a>
							<span class="num"> ${pro.count} </span>
							<a href="#" class="jiajian" data-number='1'> + </a>
						</li>
						<li class='sumprice'>
							￥<span class="jlprice"> ${pro.price * pro.count} </span>
						</li>
						<li class='delDo' data-id='${pro.id}' >
							<a href="#" class="joinCol">加入收藏夹</a>
							<a href="#" class="del">删除</a>
						</li>
					</ul>		`
		}

		$('.shoplist').html(str);

		//加减

		$('.jiajian').click(function() {
			var id = $(this).parent().data('id');
			var num = $(this).data('number');
			var count = $(this).parent().find('.num').html();
			//console.log(count)
			if(count == 1 && num == -1) {
				return;
			};
			for(var i = 0; i < arr.length; i++) {
				if(id == arr[i].id) {
					arr[i].count += num;
					//console.log(arr[i].count)
					setCookie('shoplist', JSON.stringify(arr));
					$(this).parent().find('.num').html(arr[i].count); //数量加减
					console.log(arr[i].count)
					$(this).parent().next().html('￥' + arr[i].count * arr[i].price) //价格累加
				}
			}
			jiesuan()

		});
		//清算函数
		function jiesuan() {
			var count = 0;
			var money = 0;
			$('.ck:checked').each(function() {
				count += parseInt($(this).parent().parent().parent().find('.numDo').find('.num').html());
				money += parseInt($(this).parent().parent().parent().find('.sumprice').find('.jlprice').html());
				console.log(count)
				//console.log(money);
			})
			$('.count2').html(count);
			$('.money2').html(money);
		}
		//点击单选check按钮 结算
		var flag = true;
		$('.ck').click(function() {
			if(flag) {
				$(this).prop('checked', true).parent().css('background', 'url(img/checkbox.png)');

			} else {
				$(this).prop('checked', false).parent().css('background', 'url(img/check2.png)');

			}
			flag = !flag
			jiesuan();
		});
		//全选功能  结算

		$('#allck').click(function() {
			if(flag) {
				$('.ck').prop('checked', $(this).prop('checked')).parent().css('background', 'url(img/checkbox.png)');

			} else {

				$('.ck').prop('checked', $(this).prop('checked')).parent().css('background', 'url(img/check2.png)');

			}
			flag = !flag

			jiesuan()
		});
		//删除单个
		$('.del').click(function() {
			var id = $(this).parent().data('id');
			//console.log(id);
			for(var i = 0; i < arr.length; i++) {
				if(id == arr[i].id) {
					arr.splice(i, 1);
					setCookie('shoplist', JSON.stringify(arr));
					if(confirm('确定删除该商品吗？')) {
						$(this).parent().parent().remove();
					}
				}
			}
		});
		//
		//全部删除
		$('.alldel').click(function() {
			for(var i = 0; i < arr.length; i++) {
				if(confirm('确定清空购物车吗？')) {
					arr.splice(0, arr.length);
					setCookie('shoplist', JSON.stringify(arr));
					$('.shoplist').remove();
				}
			}
		});
	}
	
	
	//猜你喜欢
		$.ajax({
			type: "get",
			url: "like.json",
			success: function(msg) {
				//var titleStr = ""
				var conStr = ""
				
					console.log(msg)
					for(var i = 0; i < msg.length; i++) {
						console.log(msg)
						var pro = msg[i];
						conStr += `
								<li>
									<a href="xiangqing.html?id=${pro.id}&name=${pro.name}&src=${pro.src}&price=${pro.price}"><img src="img/${pro.src}" /></a>
									<a href="xiangqing.html?id=${pro.id}&name=${pro.name}&src=${pro.src}&price=${pro.price}">${pro.name}</a>
									<p>${pro.price}</p>
								</li>
							`
					}
				
				$('.l-ul').html(conStr);
			}
		});
		$('.l-ul').on('click', '.joinCar', function() {
			var arr = [];
			var flag = true;
			var brr = getCookie('shoplist');
			var json = {
				id: $(this).data('id'),
				name: $(this).data('name'),
				price: $(this).data('price'),
				src: $(this).data('src'),
				count:1
			}
			//console.log(json)
			//商品信息添加进同一个arr
			var brr = getCookie('shoplist')
			if(brr.length != 0) {
				arr = brr;
				for(var i = 0; i < arr.length; i++) {
					if(json.id == arr[i].id) {
						arr[i].count++;
						flag = false;
					}
				}
			}

			//添加商品信息
			if(flag) {
				arr.push(json);
			}
			setCookie('shoplist', JSON.stringify(arr))

			if(!confirm('确定--继续购物，取消--结算购物车')) {
				location.href = 'shopcar.html';
			}

			//console.log(document.cookie)

		})
	
</script>